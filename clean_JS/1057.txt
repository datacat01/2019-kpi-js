var monetateT = new Date().getTime();

    var lpTag = lpTag || {}; lpTag.vars = lpTag.vars  || []; lpTag.dbs = lpTag.dbs || [];
    lpTag.section = 'default';
    var arrLPvars = [
        { scope:'page', name:'unit', value:'sales-' },
        { scope:'session', name:'language', value:'LanguageModel (8796093055008)' },
		// Variables that are sent on page load
        { scope:'page', name:'ProductName', value:'' }, //Name of the product; product pages only, should be "none" on non-product pages
        { scope:'page', name:'ProductPrice', value:'' }, //Price of the product, int only; product pages only, should be "0" on non-product pages
        { scope:'page', name:'ProductCategories', value:'' }, //Actual Category, whether on Category or Product page; on other pages should be "none"
        { scope:'page', name:'CategoryName', value:'' }, //Category name inside the category page; on other pages should be "none"
 		{ scope:'page', name:'CheckoutProcess', value:'' }, //Step1, Step2, etc until Confirmation page
	    { scope:'page', name:'Section', value:'' }, //Shopping, Cart, Checkout or Info
        { scope:'page', name:'CartTotal', value:'' } //Numeric value of cart value; should start a "0" and be compiled going forward
    ];
    lpTag.vars.push(arrLPvars);
  
try{Typekit.load({async:true});}catch(e){}


       globalLanguage = "en"
       


		/*<![CDATA[*/
		
		var ACC = { config: {} };
			ACC.config.contextPath = "";
			ACC.config.commonResourcePath = "/_ui/desktop/common";
			ACC.config.themeResourcePath = "/_ui/desktop/theme-black";
			ACC.config.siteResourcePath = "/_ui/desktop/site-tumi";
			ACC.config.rootPath = "/_ui/desktop";	
			ACC.config.CSRFToken = "";
			ACC.pwdStrengthVeryWeak = 'Very weak';
			ACC.pwdStrengthWeak = 'Weak';
			ACC.pwdStrengthMedium = 'Medium';
			ACC.pwdStrengthStrong = 'Strong';
			ACC.pwdStrengthVeryStrong = 'Very strong';
			ACC.pwdStrengthUnsafePwd = 'password.strength.unsafepwd';
			ACC.pwdStrengthTooShortPwd = 'Too short';
			ACC.pwdStrengthMinCharText = 'Minimum of %d characters';
			ACC.accessibilityLoading = 'Loading... Please wait...';
			ACC.accessibilityStoresLoaded = 'Stores loaded';
			
			ACC.autocompleteUrl = '/search/autocompleteSecure';
			
			
		/*]]>*/
	

	/*<![CDATA[*/
	ACC.addons = {};	//JS holder for addons properties
			
	
	/*]]>*/


		/*<![CDATA[*/
			var omnitureAccount="tuminord";
			var internalFilters="intl.tumi.com,javascript:,paypal.com,cybersource.com";
			var omnitureRegionalSite = "tumiglobal";
		/*]]>*/
	

var certonaFeed = '';
function loadCertona(data){
	certonaFeed = data;
	$(document).ready(function(){
		$(document).trigger("certonaLoaded", [data]);
	});
}
var countryIsoCode = 'US';


	// set initial value
	var isAttraqt = true;


	  LM.config("categorytree", "/");
	  LM.config("category", "");
	  LM.config("Countrycode", "US");
	  

	  LM.Currency = 'USD';

	  

	$(document).ready(function () {
		
				$.removeCookie("previousPage", {path: '/'});
				$.removeCookie("typeahead", {path: '/'});
			
	});



	

	$(function () {
		var $suggested_title = $('#suggested_categories_header'),
			$matching_title = $('#matching_products_header'),
			$search_element = $('#search'),
			$searchContainer = $('.ctnr-search-form'),
			$searchContent = $searchContainer.find('.search_header'),
			$searchResults = $('#matching_products'),
			suggestedDefault = $('#suggested_categories_header_default').text(),
			matchingDefault = $('#matching_products_header_default').text();

		$searchContainer.addClass('inactive');
		$search_element.on('keyup', function (e) {
			var text = this.value;
			$suggested_title.text(suggestedDefault + ' "' + text + '"');
			$matching_title.text(matchingDefault + ' "' + text + '"');
			
			if (!this.value) {
				$searchContainer.addClass('inactive');
			} else if ($searchContainer.hasClass('inactive')) {
				$searchContainer.removeClass('inactive');
			}

			if (isAttraqt) {
				if (!this.value) {
					$searchResults.empty();
				}
				
				if ($searchResults.children().length) {
					$searchContent.addClass('active');
					//$searchContainer.trigger('randomSlot');
				} else {
					$searchContent.removeClass('active');
				}
			}
		});

	});


var map;
var markers = [];
var infowindow;
var storelatitude = '';
var storelongitude = '';
var storename = '';
var storeaddressline1 = '';
var storeaddressline2 = '';
var storeaddresstown = '';
var storeaddresspostalCode = '';
var storeaddressregion = '';
var storeaddresscountryname = '';

function submitTracerFormFooter()
{
	var tracer = $('#tracerNumberFooter').val();
	if(tracer.length != 20){
		$('#invalidTracerFooter').css('display','block');
        $('#emptyTracerFooter').css('display','none');
        $('#footertracerform').find('.ctnr-input-with-button').css({"border-color": "#cf0000"});
        return false;
	}
    
    var ajax_url = ACC.config.contextPath + "/validate"
    $.ajax({
        type:"POST",
        cache: false,
        async: false,
        dataType:'json',
        url: ajax_url,
        data: {
            tracerNumber:tracer
        },
        success: function (data) {
            if(data =='invalid'){
            	
          $('#invalidTracerFooter').css('display','block');
          $('#emptyTracerFooter').css('display','none');
          $('#footertracerform').find('.ctnr-input-with-button').css({"border-color": "#cf0000"});
         
          return false;
            }
            if(data =='empty'){
            	
                $('#emptyTracerFooter').css('display','block');
                $('#invalidTracerFooter').css('display','none');
                $('#footertracerform').find('.ctnr-input-with-button').css({"border-color": "#cf0000"});
                return false;
                }
            if(data =='success'){
            	if ($.loginPanel.session.status < 3) {
            		$.loginPanel.open();
            		localStorage.setItem('isTumiTracerRegister', true);
            		localStorage.setItem('tracerNumber', tracer);
            		return false;
            	}else{
            	$('#footertracerform').find('.ctnr-input-with-button').css({"border-color": "#ccc"});
                $('#footertracerform').submit();
                 return true;
            	}
            }
            
        }
      });
}
$(document).ready(function (){
	if ($.loginPanel.session.status < 3) {
	setTimeout(function(){
			$(".footer-links a").click(function(e){
			e.preventDefault();
			var hrefUrl = $(this).attr("href");
			var splitHrefUrl = hrefUrl.split("/");
			if(splitHrefUrl[1] == 'my-account'){
				localStorage.setItem('cookieRedirectUrl', hrefUrl);
				window.location.href = hrefUrl;
			}else{
				window.location.href = hrefUrl;
			}
		})
		
	},300);
	}
	
	
    
    /*
    $('#country-selector-footer').bind({
        "selectboxitcreate": function(ev, obj) {
            var countrySelectorFooter = MQ.addQuery({
                context: 'small',
                match: function() {
                    var containerBox = $('div.footer-country-selector'),
                        optionsList = containerBox.find('.selectboxit-list'),
                        selectMaxWidth = optionsList.css('minWidth');
                    containerBox.find('.selectboxit-container, .selectboxit, select').css({
                        'maxWidth': selectMaxWidth,
                        'minWidth': '0',
                        'width': '100%'
                    });
                },
                unmatch: function() {
                    $('#country-selector-footer').data("selectBox-selectBoxIt").refresh();
                }
            });
        }
    });
    */
    var isIpad = (/ipad/i.test(navigator.userAgent.toLowerCase()));
    $('#country-selector-footer').on('selectboxitcreate', function(ev, obj) {
        var countrySelectorFooter = MQ.addQuery({
                context: 'small',
                match: function() {
                    var containerBox = $('div.footer-country-selector'),
                        optionsList = containerBox.find('.selectboxit-list'),
                        selectMaxWidth = optionsList.css('minWidth');
                    containerBox.find('.selectboxit-container, .selectboxit, select').css({
                        'maxWidth': selectMaxWidth,
                        'minWidth': '0',
                        'width': '100%'
                    });
                },
                unmatch: function() {
                    $('#country-selector-footer').data("selectBox-selectBoxIt").refresh();
                }
        });

        // TUMIPRO-8210 - fix ipad issue with closing select box
        if (isIpad) $('#country-selector-footerSelectBoxItArrow').off('click').on('click', function (e) { e.stopPropagation(); });
    });

    $("a.removeLink").replaceWith($("a.removeLink").html());
    var w=$(this).width();
    if( w > 1279){
		
		$('.footer-links').each(function(){
			
			$(this).removeClass('span6').addClass('span8');
		});
		$('.footer-locator').each(function(){
			$(this).removeClass('span6').addClass('span4');
		});
		
		$('.footer-newsletter').each(function(){
			$(this).removeClass('span6').addClass('span4');
		});
		$('.footer-register').each(function(){
			$(this).removeClass('span6').addClass('span4');
		});
		$("#footer-language-selector").css('margin-left', '');
		var s = $(".footer-social");
		$(".footer-social").remove();
		$(".footer-row-2").prepend(s); 
		$("#lang-selectorSelectBoxIt").addClass("alt-dropdown-2");
		$(".footer-row-2").css('border-top', '');
		$(".footer-language-selector").css('margin-left', '');
		
		$(".clr-size-qty").css('width', '');
		$(".clr-size-qty").css('padding-left', '');

	}
	else if (w > 767 && w <= 1279)
	{
	
		$('.footer-newsletter').each(function(){
			$(this).removeClass('span4').addClass('span6');
		});
         $('.footer-links').each(function(){
			
			$(this).removeClass('span8').addClass('span6');
		});
		$('.footer-register').each(function(){
			$(this).removeClass('span4').addClass('span6');
		});
		$('.footer-locator').each(function(){
			$(this).removeClass('span4').addClass('span6');
		});
		$('.footer-contact').each(function(){
			$(this).removeClass('span8').addClass('span6');
			$(this).css('border-right','1px solid white');
		});
		$('.footer-region').each(function(){
			$(this).removeClass('span8').addClass('span6');
		});
		$("#country-selector-footerSelectBoxItContainer").css('width', '');
		$("#country-selector-footerSelectBoxItContainer").css('min-width', '');
		$("#country-selector-footerSelectBoxItContainer").css('width', '147px');
		$("#country-selector-footerSelectBoxItContainer").css('min-width', '147px');
		
		$("#country-selector-footerSelectBoxIt").css('width', '');
		$("#country-selector-footerSelectBoxIt").css('min-width', '');
		$("#country-selector-footerSelectBoxIt").css('width', '147px');
		$("#country-selector-footerSelectBoxIt").css('min-width', '147px');
		
		$("#footer-language-selector").css('margin-left', '');
		$("#footer-language-selector").css('margin-left', '27px');
		$(".footer-language-selector").css('margin-left', '');
		$(".footer-language-selector").css('margin-left', '27px');

		var s = $(".footer-social");
		$(".footer-social").remove();
		$(".footer-row-3").prepend(s);
		$(".footer-row-2").css('border-top', '');
		
		$(".clr-size-qty").css('width', '');
		$(".clr-size-qty").css('padding-left', '');
	}

	else{
		$('.footer-top-row .span6').each(function(){
			//$(this).removeClass('span6').addClass('span8');
			
			
		})
		$(".footer-row-2").css('border-top', '1px solid white');
		$("#country-selector-footerSelectBoxItOptions").css('width', '');
		$("#country-selector-footerSelectBoxItOptions").css('min-width', '');
		$("#country-selector-footerSelectBoxItOptions").css('width', '100%');
		$("#country-selector-footerSelectBoxItOptions").css('min-width', '100%');
		$("#footer-language-selector").css('margin-left', '');
		$(".footer-language-selector").css('margin-left', '');
		if($('.size-blk').length == 0)
		{
			$(".clr-size-qty").css('width', '350px');
    		$(".clr-size-qty").css('padding-left', '10px');
		}
		
	}
    $(window).resize(function(){
    	
    	var w=$(this).width();
    	if( w > 1279){
    		
    		$('.footer-links').each(function(){
    			
    			$(this).removeClass('span6').addClass('span8');
    		});
    		$('.footer-locator').each(function(){
    			$(this).removeClass('span6').addClass('span4');
    		});
    		
    		$('.footer-newsletter').each(function(){
    			$(this).removeClass('span6').addClass('span4');
    		});
    		$('.footer-register').each(function(){
    			$(this).removeClass('span6').addClass('span4');
    		});
    		$("#footer-language-selector").css('margin-left', '');
    		var s = $(".footer-social");
    		$(".footer-social").remove();
    		$(".footer-row-2").prepend(s); 
    		$("#lang-selectorSelectBoxIt").addClass("alt-dropdown-2");
    		$(".footer-row-2").css('border-top', '');
    		$(".footer-language-selector").css('margin-left', '');
    		
    		$(".clr-size-qty").css('width', '');
    		$(".clr-size-qty").css('padding-left', '');

    	}
    	else if (w > 767 && w <= 1279)
    	{
    	
    		$('.footer-newsletter').each(function(){
    			$(this).removeClass('span4').addClass('span6');
    		});
             $('.footer-links').each(function(){
    			
    			$(this).removeClass('span8').addClass('span6');
    		});
    		$('.footer-register').each(function(){
    			$(this).removeClass('span4').addClass('span6');
    		});
    		$('.footer-locator').each(function(){
    			$(this).removeClass('span4').addClass('span6');
    		});
    		$('.footer-contact').each(function(){
    			$(this).removeClass('span8').addClass('span6');
    			$(this).css('border-right','1px solid white');
    		});
    		$('.footer-region').each(function(){
    			$(this).removeClass('span8').addClass('span6');
    		});
    		$("#country-selector-footerSelectBoxItContainer").css('width', '');
    		$("#country-selector-footerSelectBoxItContainer").css('min-width', '');
    		$("#country-selector-footerSelectBoxItContainer").css('width', '147px');
    		$("#country-selector-footerSelectBoxItContainer").css('min-width', '147px');
    		
    		$("#country-selector-footerSelectBoxIt").css('width', '');
    		$("#country-selector-footerSelectBoxIt").css('min-width', '');
    		$("#country-selector-footerSelectBoxIt").css('width', '147px');
    		$("#country-selector-footerSelectBoxIt").css('min-width', '147px');
    		
    		$("#footer-language-selector").css('margin-left', '');
    		$("#footer-language-selector").css('margin-left', '27px');
    		$(".footer-language-selector").css('margin-left', '');
    		$(".footer-language-selector").css('margin-left', '27px');

    		var s = $(".footer-social");
    		$(".footer-social").remove();
    		$(".footer-row-3").prepend(s);
    		$(".footer-row-2").css('border-top', '');
    		
    		$(".clr-size-qty").css('width', '');
    		$(".clr-size-qty").css('padding-left', '');
    	}

    	else{
    		$('.footer-top-row .span6').each(function(){
    			//$(this).removeClass('span6').addClass('span8');
    			
    			
    		})
    		$(".footer-row-2").css('border-top', '1px solid white');
    		$("#country-selector-footerSelectBoxItOptions").css('width', '');
    		$("#country-selector-footerSelectBoxItOptions").css('min-width', '');
    		$("#country-selector-footerSelectBoxItOptions").css('width', '100%');
    		$("#country-selector-footerSelectBoxItOptions").css('min-width', '100%');
    		$("#footer-language-selector").css('margin-left', '');
    		$(".footer-language-selector").css('margin-left', '');
    		if($('.size-blk').length == 0)
    		{
    			$(".clr-size-qty").css('width', '350px');
        		$(".clr-size-qty").css('padding-left', '10px');
    		}
    		
    		
    	}
    });
    
    $('#newsletteremaildFooter').change(function() {    
		$(this).val($(this).val().replace(/ /g,"").toUpperCase());
	});
    
    $('#tracerNumberFooter').change(function() {    
		$(this).val($(this).val().replace(/ /g,"").toUpperCase());
	});
});

/* window.onload = function() {
	$('.chat').text($('.footer-chat-txt').text());
}; */

/* window.onload = function() {
	setTimeout(function(){$('.footer-links').find('#tumiChatButton2 .chat').text('Chat'); }, 100);
	$('.footer-links').find('#tumiChatButton2').css('visibility', 'visible');
}; */



$(document).ready(function() {

    if (!$('body').hasClass('mq_small') && $("#firstTimeEmailSignupPopup div").length > 0) {

        emailEntrySignupPopup();
    }

    $(".close-overlay").on('click',function() {
        $.cookie("isFirstTimeUser", "no", {
            expires: 365,
            path: '/'
        });
        $.magnificPopup.close();
    });


});


function emailEntrySignupPopup() {
    if ($.cookie("isFirstTimeUser") != "no" && (!$('body').hasClass('page-privacypolicyPage')) && typeof flashSaleFlag == 'undefined') {
        $.cookie("isFirstTimeUser", "yes", {
            expires: 365,
            path: '/'
        });

        $("#emailsignupmodal").on('click',function() {
            registerForNewsLetterEntrySignUp();
        });

        $.magnificPopup
            .open({
                items: {
                    src: $('#firstTimeEmailSignupPopup')
                },
                type: 'inline',
                closeMarkup: '<div title="%title%" class="close-overlay mfp-close ctnr-mfp-close"><span class="icon icon-x mfp-close"></span></div>',
                closeBtnInside: true,
                modal: true,
                callbacks: {
                    open: function() {
                        setTimeout("$('.mfp-bg').height($(document).height())", 1500);
                    }

                }
            });
    }
}


function registerForNewsLetterEntrySignUp() {

    var email = $("#emailEntrySignupInput").val();
    var successMsg, errorMsg, duplicateEmail;

    if (checkEmailEntrySignUp()) {
        $('.loaderformodalsuccess').removeClass('hidden');
        var ajax_url = ACC.config.contextPath + "/view/EmailSignupModalComponentController/signupnewsletter";
        $.ajax({
            url: ajax_url,
            type: "POST",
            cache: false,
            dataType: "text",
            data: {
                checkDuplicate: 1,
                email: email,
                source: "emaillayover"
            },
            success: function(data) {

                var emailPopup = $("#firstTimeEmailSignupPopup");

                successMsg = $(emailPopup).find("#responseSuccessMsgEntrySignUp");
                errorMsg = $(emailPopup).find("#responseInvalidEmailEntrySignUp");
                duplicateEmail = $(emailPopup).find("#responseDuplicateMsgEntrySignUp");


                if (data == 'true') {
                    footerMsg = duplicateEmail;
                    $('#newsletteremaildFooter').val('');
                } else {
                    footerMsg = successMsg;
                }

                if (footerMsg.length > 0) {
                    $(footerMsg).show();
                }
                $('.loaderformodalsuccess').addClass('hidden');
               
                //$("#incentiveMessageEntrySignUp").show();

                $.cookie("isFirstTimeUser", "no", {
                    expires: 365,
                    path: '/'
                });
                setTimeout(function() {
                    $.magnificPopup.close();

                }, 2500);

            }
        });
    }

}


/*

var ajax_url = ACC.config.contextPath + "/view/ResponsiveNewsletterComponentController/signupnewsletter";     
              $.ajax({
                    url: ajax_url,
                    type: "POST",
                    cache:false,
                    dataType: "text",
                    data: {
                        email: email,
                    source: 'firstTimeUser'
        
                    },
                    success: function (data) {

                    }});


*/


function checkEmailEntrySignUp() {

    var email = $("#emailEntrySignupInput").val();
    var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    var emailPopup = $("#firstTimeEmailSignupPopup");

    $(emailPopup).find("#responseSuccessMsgEntrySignUp").hide();
    $(emailPopup).find("#responseDuplicateMsgEntrySignUp").hide();
    $(emailPopup).find("#responseInvalidEmailEntrySignUp").hide();

    if (!filter.test(email)) {
        var footerMsg = document.getElementById("responseInvalidEmailEntrySignUp");
        footerMsg.style.display = "block";
        email.focus;
        $('#newsletteremaildFooter').val('');
        return false;
    }
    return true;
}


  $(document).ready(function() {
	if ($.cookie("cookie-overlay-seen") != "yes" && (window.location.host.indexOf('www') != 0 && window.location.host.indexOf('ca') != 0)){
		$('.cookie-policy-overlay').removeClass('hidden');
		$.cookie("cookie-overlay-seen", "yes", { expires: 365, path: '/' });
 	}
	  
   var docHeight = $(window).height();
   var footerHeight = $('.cookie-policy-overlay').height();
   var footerTop = $('.cookie-policy-overlay').position().top + footerHeight;
   
   if (footerTop < docHeight) {
    $('.cookie-policy-overlay').css('margin-top', 10 + (docHeight - footerTop) + 'px');
   }
   
  /*setTimeout(function(){ 
	  $('.cookie-policy-overlay').fadeOut('slow');
   }, 15000);*/

   $('.close-cookie-overlay').click(function(){
	   $('.cookie-policy-overlay').fadeOut('slow');
   });
   
  });
 

// default
window.tm = window.tm || {};
window.tm.defaults = window.tm.defaults || {};
// default login panel
window.tm.defaults.loginPanel = {messages : {}};
window.tm.defaults.loginPanel.widgetLoaded = false;
// set default messages
window.tm.defaults.loginPanel.messages.required = "{0} is required";
window.tm.defaults.loginPanel.messages.email = "{0} must be valid";
window.tm.defaults.loginPanel.messages.equalTo = "{0} must match";
window.tm.defaults.loginPanel.messages.validPassword = "{0} must be at least 6 characters and contain at least 1 letter and 1 number";
window.tm.defaults.loginPanel.messages.minlength = "{0} must be at least {1} characters";
window.tm.defaults.loginPanel.messages.errors = {
	invalid : "Oops! Please correct the above to proceed.",
	default : "There was an unexpected problem, please try again."
	//duplicate : "An account already exists for this email address.",
	//authFailed : "Your username and/or password is incorrect.",// login.error.account.not.found.title

};
window.tm.defaults.loginPanel.messages.pwstrength = {
	veryWeak : "very weak",
	weak : "weak",
	normal : "normal",
	medium : "medium",
	strong : "strong",
	veryStrong : "very strong"
};


(function() {

	if (typeof window.janrain !== 'object') window.janrain = {};
	if (typeof window.janrain.settings !== 'object') window.janrain.settings = {};

	/* _______________ can edit below this line _______________ */
	janrain.settings.actionText = ' ';
	janrain.settings.tokenAction = 'event';
	janrain.settings.tokenUrl = 'https://intl.tumi.com/auth/socialLogin';
	janrain.settings.language = 'en';
	/* _______________ can edit above this line _______________ */

	function isReady() {
		janrain.ready = true;
		//janrain.settings.debug.enabled = true;
	};

	// todo: test in other browser (event listener)
	function updateConfig() {
		var country = 'US';

		//console.info('xxx', country, window.janrain.settings.providers);

		if (country.toLowerCase() === 'kr') return;

		var hasProviders = (window.janrain.settings.providers && window.janrain.settings.providers.length > 2);

		if (hasProviders) window.janrain.settings.providers.pop();
	}


	var e = document.createElement('script');
	e.type = 'text/javascript';
	e.id = 'janrainAuthWidget';


	if (document.addEventListener) {
	  document.addEventListener("DOMContentLoaded", isReady, false);
	  e.addEventListener("load", updateConfig, false);
	} else {
	  window.attachEvent('onload', isReady);
	  e.attachEvent('load', updateConfig);
	}


	if (document.location.protocol === 'https:') {
	  e.src = 'https://rpxnow.com/js/lib/tumi-prod/engage.js';
	} else {
	  e.src = 'http://widget-cdn.rpxnow.com/js/lib/tumi-prod/engage.js';
	}

	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(e, s);
})();


// called by janrain script
function janrainWidgetOnload() {
	// bind to widget events if possible so we can override them
	if (typeof $.loginPanel !== 'undefined' && $.loginPanel.initiated) $.loginPanel.janrain.initWidget(window.janrain);
	// update state to avoid race condition
	window.tm.defaults.loginPanel.widgetLoaded = true;
}

jQuery(function ($) {
	//////////////////////
	// Login Panel
	//////////////////////

	// move login panel
	$('.ctnr-wrapper').append($('#tm-login'));

	// set default messages
	$.extend(true, $.loginPanel.messages, window.tm.defaults.loginPanel.messages);

	// set flag for checkout page
	var isCheckoutPage = $('body').hasClass('page-singleCheckoutPage'),
		isOrderConfirmationPage = $('body').hasClass('page-orderConfirmationPage'),
		isPdpPage = $('body').hasClass('page-productDetails'),
		isUnitedAirlineLoginPage = $('body').hasClass('page-unitedairlines');

	// set plugin debug mode
	$.loginPanel.debug = false;
	// init plugin
	$.loginPanel.init({
		endpoint : {
			login : ACC.config.contextPath + '/auth/login',
			register : ACC.config.contextPath + '/auth/register',
			social : ACC.config.contextPath + '/auth/socialLogin',
			reset : ACC.config.contextPath + '/auth/reset-password',
			instagram : ACC.config.contextPath + '/auth/socialRegistration',
			session : ACC.config.contextPath + '/session/status'
		},
		dom : { el : '#tm-login' },
		closeAfterAuth : isCheckoutPage,
		reloadAfterAuth : !isOrderConfirmationPage
	});

	// bind to widget events if it hasn't done so already
	if (!$.loginPanel.janrain.initiated && window.tm.defaults.loginPanel.widgetLoaded) $.loginPanel.janrain.initWidget(window.janrain);


	//////////////////////
	// Minicart
	//////////////////////
	// set default
	tm = window.tm || {};
	// set instance
	var tumiMinicart = typeof tm.minicart === 'undefined' ? false : tm.minicart({
		debug : false,
		endpoint : {
			mini : ACC.config.contextPath + '/cart/mini/MiniCart',
			remove : ACC.config.contextPath + '/cart/deleteItem',
			messages : ACC.config.contextPath + '/cart/mini/messages'
		},
		throttle : {
			threshold : 60// secs
		},
		dom : { el : '#tm-panel-mini-cart' }
	});

	//////////////////////
	// Events
	//////////////////////

	// select all footer links and filter the my-account links
	var $footerSuperSet = $('.ctnr-footer .footer-links, .ctnr-footer .visible-phone');
	var $footerLinks = $footerSuperSet.find('a[href*="/my-account"]');
		$footerLinks = $footerLinks.filter(function () {
			var $this = $(this);
			var allowed = ['overview'];
			var href = $this.attr('href');
				href = href[0] === '/' ? href.slice(1) : href;
				href = href.split('/');
				href.shift();

			return (!href.length || $.inArray(href[0], allowed) !== -1) ? true : false;
		});

	// select /trackyourorder links for custom functionality
	// anonymous user should go to /trackyourorder but signed in user need to go to /my-account
	// $footerSuperSet.find('a[href*="/trackyourorder"]').on('click', function () {
	// 	if ($.loginPanel.session.status >= 2) {
	// 		window.location.href = '/my-account/orders';
	// 		return false;
	// 	}
	// });

	// select all header login links
	// change background color for header signin button if ready, else don't do anything
	var $targets = $('#signInDiv, #expiredDiv .header-login-name, #loggedInDiv .header-login-name, .tm-checkout .singlePageCheckout-login, .ctnr-header-checkout .header-login a, .ctnr-checkout-sign-in > a.btn-drawer, .checkout-sign-in-mobile, .page-orderConfirmationPage .create-account-btn, .tm-panel-signin');

	$targets.on('click', function (e) {
		var UNKNOWN = -1,
			LOGGED_IN = 3;
		if ($.loginPanel.session.status === UNKNOWN) return false;
		if ($.loginPanel.session.status < LOGGED_IN) {
			$(this).closest('.header-login').addClass('active');
		}
	});

	// [TUMIPRO-12746] - UA link should open login panel
	if (isUnitedAirlineLoginPage) {
		$targets = $targets.add('a[href="/unitedoffers"]');
	}

	// override site normal behaviour for header links & footer links
	// and then bind elements that will open the panel
	$.loginPanel.bind($targets.add($footerLinks), $('#tm-panel-login'), function () {
		var DO_NOTHING = -1,
			FOLLOW_LINK = 0,
			OPEN_PANEL = 1,
			UNKNOWN = -1,
			LOGGED_IN = 3;
		// wait for initial session check - preventDefault
		if ($.loginPanel.session.status === UNKNOWN) return DO_NOTHING;
		// no point in redirecting until logged in
		if ($.loginPanel.session.status < LOGGED_IN) return OPEN_PANEL;

		return FOLLOW_LINK;
	});

	// bind elements that will open minicart
	$.loginPanel.bind($('#minicart_data'), $('#tm-panel-mini-cart'), function () {
		var DO_NOTHING = -1,
			FOLLOW_LINK = 0,
			OPEN_PANEL = 1;
			// don't open if window has mobile size
		var isMobileScreen = $(window).width() < 768,
			// don't open if locale texts are still loading
			stillLoadingText = !tumiMinicart.hasMessages(),
			// don't open if total is 0
			hasZeroItems = !tumiMinicart.getItemTotal(),
			// don't open if on cart page
			isCartPage = window.location.pathname.toLowerCase() === '/cart';

		if (isMobileScreen) return FOLLOW_LINK;

		//if (stillLoadingText || hasZeroItems || isCartPage) return DO_NOTHING;
         if (stillLoadingText || isCartPage) return DO_NOTHING;

         if (hasZeroItems){
         	if(window.location.href.indexOf("specialmarkets")>=0){
              	return FOLLOW_LINK;
        	}
           	else{
                return DO_NOTHING;
            }
          }
		

		// focus on checkout button
		setTimeout(function(){$('.checkBtn').focus()},300);

		return OPEN_PANEL;
	});

	// bind elements that will close the panel
	$('.menu-control, .menu-close-btn, .login-close-btn, .close-checkout a, .tm-panel .tm-close, .monogram-close, #tm-panel-monogram .tm-close, #tm-panel-metal-monogram .tm-close, .cancelBtn')
	.on('click', function () {
		$.loginPanel.close();
		localStorage.removeItem('isTumiTracerRegister');
		localStorage.removeItem('tracerNumber');
		//$.cookie('cookieRedirectUrl',null, { path: '/' });
		localStorage.removeItem('cookieRedirectUrl');
	});

	$(document).keyup(function(e) {
		  if (e.which == 27){
			  $.loginPanel.close();
			  localStorage.removeItem('isTumiTracerRegister');
			  localStorage.removeItem('tracerNumber');
			  //$.cookie('cookieRedirectUrl',null, { path: '/' });
			  localStorage.removeItem('cookieRedirectUrl');
		  }
	});

	// events fired by the login panel
	$('#tm-login')
	// .on('didSwitch.loginPanel', function (e, data) {
	// 	// abort
	// 	if (!data || !data.panel) return;

	// 	$('#tm-login .jspPane').css('top', 0);
	// 	// var $pane = data.panel.find('.jspPane');
	// 	// if ($pane.length) {
	// 	// 	$pane.css('top', 0);
	// 	// }

	// 	//if (typeof data.panel.reinitialise !== 'undefined') data.panel.reinitialise();
	// })
	.on('didClose.loginPanel', function (e, data) {
		var isMobileScreen = $(window).width() < 768;

		// update button states
		$('.login-close-btn').addClass('hidden');
		$('.menu-control').removeClass('hidden');
		$('.header-login').removeClass('active');
		$('#minicart_data').removeClass('active');
		$('#tm-panel-monogram').addClass('hidden');
		$('#tm-panel-metal-monogram').addClass('hidden');
		$('.tm-content').removeClass('open');

		if ( !isPdpPage ) {
			// reset the monogram panel when close
			$(".monogram-progress-bar .header-progress-item").first().addClass('done').siblings().removeClass('done');
			$(".personalization-monogram-preview").removeClass('hidden').siblings().addClass('hidden');
		}

		if(($('body').hasClass('pageType-ProductPage') || $('body').hasClass('pageType-CategoryPage') || $('body').hasClass('template-pages-search-searchGridPage') || $('body').hasClass('template-pages-AccountPurchasePageTemplate')) && isMobileScreen) {
			$('.back-to-top-link').removeClass('hidden');
		}

		// exception for order confirmation page
		// go to my-account after closing the login panel
		if (isOrderConfirmationPage && data && data.reload) {
			window.location.href = '/my-account';
		}
	})
	.on('didOpen.loginPanel didSwitch.loginPanel', function (e, data) {
		// abort
		if (!data || !data.panel) return;

		var panel = data.panel[0].id;
		$('.tm-panel .live-chat-link').hide();
		var isMobileScreen = $(window).width() < 768;
		if (isMobileScreen) {
			$('.ctnr-header').removeClass('is-hidden');
        	$('.ctnr-header').removeClass('compressed');
        	$('.ctnr-search-form').removeClass('is-open');
        	$('.search-control').removeClass('active');
		}

		// reset button states
		if (e.type === 'didSwitch') {
			$('.login-close-btn').addClass('hidden');
			$('.menu-control').removeClass('hidden');
			$('.header-login').removeClass('active');
			$('#minicart_data').removeClass('active');

			// exception for monogram panel
			// when switch don't hide the background image
			if (panel == 'tm-panel-monogram' || panel== 'monogram-step1' || panel=='monogram-step2' || panel=='monogram-step3') {
				$('#tm-panel-monogram').removeClass('hidden');
			} else{
				$('#tm-panel-monogram').addClass('hidden');

			};
		}
		// minicart
		if (panel === 'tm-panel-mini-cart') {
			// update button states
			$('.header-login').removeClass('active');
			$('#minicart_data').addClass('active');
		}else {
			// update button states
			$('.login-close-btn').removeClass('hidden');
			$('.menu-control').addClass('hidden');
			$('.header-login').addClass('active');
			$('#tm-login-form').find('#j_username').focus();
			$('#tm-login .close-checkout .icon').removeClass('hidden');
		}

		if(panel == 'tm-panel-monogram' || panel== 'monogram-step1' || panel=='monogram-step2' ||panel=='monogram-step3'){
			// update button states
			if (isMobileScreen){
				$('#tm-login .close-checkout .icon').addClass('hidden');
				$('#tm-login .tm-close .icon-x').addClass('hidden');
			}
		}

		if((panel == 'tm-panel-monogram' || panel == 'tm-panel-metal-monogram' || panel== 'monogram-step1' || panel== 'metal-monogram-step1' || panel=='monogram-step2' || panel== 'metal-monogram-step2' || panel=='monogram-step3' || panel=='metal-monogram-step3') && isMobileScreen) {
			$('.back-to-top-link').addClass('hidden');
		}
		//'tm-panel-login'
	})
	.on('didLogin.loginPanel', function (e, data) {
		// [TUMIPRO-12746]
		if (isUnitedAirlineLoginPage) {
			window.location.href = '/unitedoffers';
			return;
		}

		if($('body').hasClass('page-repairServices')){
			window.location.href = '/my-account/repair-services';
		}
		// [TUMIPRO-12291] - @Sunil
		var isTumiTracerRegister = localStorage.getItem('isTumiTracerRegister');
		var tracerNumber = localStorage.getItem('tracerNumber');
		var cookieRedirectUrl = localStorage.getItem('cookieRedirectUrl');

		if(isTumiTracerRegister && isTumiTracerRegister != 'null' && tracerNumber != 'null'){
			
	        localStorage.removeItem('isTumiTracerRegister');
			localStorage.removeItem('tracerNumber');
			window.location.href = '/tumi-tracer?tracerNumber='+tracerNumber;
		}
	});

	// update the cart total in the header
	$('#tm-login').on('update.minicart', function (e, data) {
		if (data && typeof data.total !== 'undefined'){
			$('#minicart_data .item-count').text(data.total);
			$('.header-minicart').attr('aria-label', data.total + ' ' + $('.itemsInShoppingCart').text());

			// focus on checkout button
			setTimeout(function(){$('.checkBtn').focus()},300);
		}
	});

	// check user's session status
	$.loginPanel.status(function (status) {
		var	LOGGED_IN = 3;

		// update status
		$.loginPanel.session.status = status;

		// [TUMIPRO-12746]
		if (isUnitedAirlineLoginPage && $.loginPanel.session.status === LOGGED_IN) {
			window.location.href = '/unitedoffers';
			return;
		}

		// update mobile login link
		var $mobileSignin = $('.nav-service-wrapper .sign-in  .sign-in-link').addClass('hidden');
			$mobileSignin = $.loginPanel.session.status < LOGGED_IN ? $mobileSignin.filter('.link-signin') : $mobileSignin.filter('.link-account');
		// show link
		$mobileSignin.removeClass('hidden');

		// check URL & automatically open login panel
		if ($.loginPanel.session.status < LOGGED_IN && window.location.hash === '#expired') {
			$.loginPanel.open();
			// reset hash
			window.location.hash = '';
		}

		if (window.location.hash === '#force-open') {
			$.loginPanel.open();
			// reset hash
			window.location.hash = '';
		}
	});

	// note: seem like there's code somewhere that removes click events on MOBILE login link, this is a workaround
	setTimeout(function () {
		MQ.addQuery({
			context: 'small',
			match : function () {
				var UNKNOWN = -1,
					LOGGED_IN = 3;

				$('.nav-service-wrapper .sign-in a').not('.link-signout')
				.on('click', function () {
					if ($.loginPanel.session.status === UNKNOWN) return false;
					if ($.loginPanel.session.status < LOGGED_IN) {
						$('.menu-close-btn').click();
						$.loginPanel.toggle($('#tm-panel-login'));
					}
				});
			},
			unmatch : function () {}
		});
	}, 2000);

});

// @Naveen
function accountActivate(message) {

	if(message == "Your account expired, you have been not using store log in for the 1 or 3 or year so the account has been dormant, do you want to activate it."){
		 $("#account-activate").hide();
		 $("#confirm-account-activation").show();
		 $("#login-option-regular").hide();
		 $('#j_accountActivate').attr('checked', true);
		 $("#loginSubTitle").hide();
		 $("#account-activate-SubTitle").show();
		 $("#janrainEngageEmbed").hide();
		 $("#termsandconditions").hide();
		 $("#create-account-section").hide();
	}else{
		 $("#account-activate").hide();
		 $('#j_accountActivate').attr('checked', false);
		 $("#confirm-account-activation").hide();
		 $("#login-option-regular").show();
		 $("#loginSubTitle").show();
		 $("#account-activate-SubTitle").hide();
		 $("#janrainEngageEmbed").show();
		 $("#create-account-section").show();
		 $("#termsandconditions").show();
	}
}

$('.btn-drawer').on('click', function(e) {
	 $("#account-activate").hide();
	 $('#j_accountActivate').attr('checked', false);
	 $("#confirm-account-activation").hide();
	 $("#login-option-regular").show();
	 $("#loginSubTitle").show();
	 $("#account-activate-SubTitle").hide();
	 $("#janrainEngageEmbed").show();
	 $("#create-account-section").show();
	 $("#termsandconditions").show();
});

$(document).ready(function(){
	$('body').on('keydown', '.tm-header .close', function(e) {
		if(e.shiftKey && e.which == 9) {
			setTimeout(function(){$('.continueShopBtn').focus()},100);
		}
	});

	$('body').on('keydown', '.continueShopBtn', function(e) {
		var code = (e.keyCode ? e.keyCode : e.which);
		 if(!e.shiftKey && e.which == 9) {
			 setTimeout(function(){ $('.tm-header').find('.close').focus();},100);
	     }
	});

	$('body #tm-panel-login').on('keydown', '.live-chat-link', function(e) {
		var code = (e.keyCode ? e.keyCode : e.which);
		 if(!e.shiftKey && e.which == 9) {
			 setTimeout(function(){ $('#tm-panel-login').find('.tm-close').focus();},100);
	     }
	});

	$('body #tm-panel-login').on('keydown', '.tm-close', function(e) {
		if(e.shiftKey && e.which == 9) {
			setTimeout(function(){$('#tm-panel-login').find('.live-chat-link').focus()},100);
		}
	});


	$('body #tm-panel-register').on('keydown', '.live-chat-link', function(e) {
		var code = (e.keyCode ? e.keyCode : e.which);
		 if(!e.shiftKey && e.which == 9) {
			 setTimeout(function(){ $('#tm-panel-register').find('.tm-close').focus();},100);
	     }
	});

	$('body #tm-panel-register').on('keydown', '.tm-close', function(e) {
		if(e.shiftKey && e.which == 9) {
			setTimeout(function(){$('#tm-panel-register').find('.live-chat-link').focus()},100);
		}
	});

});


		if(typeof Tumi == "undefined" || !Tumi){ var Tumi = (function(){return{};})(); }
		if(typeof Tumi.vars == "undefined" || !Tumi.vars){ Tumi.vars = (function(){return{};})(); }


		$(function() {
			$("#prod_tabs").tabs({
				selected : 0
			});
		});
	

	$(function() {
		$("#prod_tabs").tabs({
			selected : 0
		});
	});


	$.fn.andSelf = $.fn.addBack;
	$.fn.curCSS = $.fn.css;



<!--
	/* Get the AppMeasurement instance */
	var s=s_gi("tuminord")

	/* Events */
	s.events="event39"

	/* Traffic Variables. */
	s.prop13="en_US"
	s.prop14="USD"
	s.prop15="US"
	s.server=window.location.hostname
	s.prop30=window.location.pathname
	s.prop2="Browse"
	s.prop34="[Breadcrumb Trail]"


		s.prop34="Home Page"
		s.prop2="Home"
	
	s.pageName=s.eVar43=s.prop13+":"+s.prop34
	/* Conversion Variables */
	/* Final s_code declaration */
	var s_code=s.t();if(s_code)document.write(s_code);//-->

