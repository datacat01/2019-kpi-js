(window.webpackJsonp=window.webpackJsonp||[]).push([["Chat~Governance~Reddit~RedesignChat"],{"./src/chat/actions/promo/constants.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return r}),t.d(e,"b",function(){return o});var r="PROMO__DISPLAY_PROMO",o="PROMO__HIDE_PROMO"},"./src/chat/constants/channels.ts":function(n,e,t){"use strict";var r,o;t.d(e,"b",function(){return r}),t.d(e,"a",function(){return o}),t.d(e,"g",function(){return u}),t.d(e,"f",function(){return i}),t.d(e,"d",function(){return s}),t.d(e,"e",function(){return a}),t.d(e,"c",function(){return c}),function(n){n.JOINED="JOINED",n.INVITED="INVITED",n.PARTIAL="PARTIAL",n.UNSORTED="NONE"}(r||(r={})),function(n){n.BLOCK="block",n.CREATE="create",n.DECLINE_REQUEST="decline",n.INVITE_MEMBERS="invite",n.INVITE_MEMBERS_CONFIRMATION="invite_confirmation",n.DENY="deny",n.LEAVE="leave",n.LOCK_CHANNEL_CONFIRMATION="lock_confirmation",n.VIEW_JOIN="join",n.VIEW_MEMBERS="members",n.VIEW_NSFW_CONFIRMATION="nsfw",n.VIEW_PRIVATE="private",n.VIEW_INVITE="invited"}(o||(o={}));var i,u=[o.DENY,o.VIEW_JOIN,o.VIEW_PRIVATE];!function(n){n.NonSuper="nonsuper",n.Super="super"}(i||(i={}));var c,s=30,a=99;!function(n){n.All="all",n.UnreadMessages="unread_message_count_only",n.Off="off"}(c||(c={}))},"./src/chat/constants/messages.ts":function(n,e,t){"use strict";var r,o,i;t.d(e,"c",function(){return r}),t.d(e,"b",function(){return o}),t.d(e,"a",function(){return i}),function(n){n.ADMIN="admin",n.USER="user",n.PENDING="pending"}(r||(r={})),function(n){n.TEXT="text",n.POST="post",n.EMBED="embedCollection",n.SNOOMOJI="snoomoji"}(o||(o={})),function(n){n.DELETE="delete",n.REPORT="report"}(i||(i={}))},"./src/chat/constants/sendbird.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return o}),t.d(e,"b",function(){return r});var r,o="sendbird_group_channel_";!function(n){n.Open="OPEN",n.Closed="CLOSED",n.Pending="PENDING"}(r||(r={}))},"./src/chat/endpoints/sendbird/index.ts":function(n,e,t){"use strict";t.d(e,"e",function(){return j}),t.d(e,"h",function(){return S}),t.d(e,"g",function(){return _}),t.d(e,"c",function(){return T}),t.d(e,"m",function(){return E}),t.d(e,"k",function(){return k}),t.d(e,"a",function(){return x}),t.d(e,"i",function(){return w}),t.d(e,"f",function(){return M}),t.d(e,"l",function(){return N}),t.d(e,"b",function(){return P}),t.d(e,"j",function(){return U}),t.d(e,"d",function(){return A});var r,o,i,u,c,s,a,d,l,f,m=t("./node_modules/babel-runtime/regenerator/index.js"),b=t.n(m),h=t("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=t.n(h),g=t("./src/config.ts"),v=t("./src/lib/constants/index.ts"),I=t("./src/lib/makeApiRequest/index.ts"),C=t("./src/lib/omitHeaders/index.ts"),y=t("./src/reddit/constants/headers.ts"),O=t("./src/chat/models/Channel/utils/index.ts"),j=(r=p()(b.a.mark(function n(e){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(Object(C.a)(e,[y.a]),{endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/config",method:v.jb.GET}));case 1:case"end":return n.stop()}},n,void 0)})),function(n){return r.apply(this,arguments)}),S=(o=p()(b.a.mark(function n(e,t){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/me",method:v.jb.GET}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e){return o.apply(this,arguments)}),_=(i=p()(b.a.mark(function n(e,t,r){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/contacts?limit="+r,method:v.jb.GET}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e,t){return i.apply(this,arguments)}),T=(u=p()(b.a.mark(function n(e,t,r,o){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{data:{users:r,name:o},endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/group_channels",method:v.jb.POST,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e,t,r){return u.apply(this,arguments)}),E=(c=p()(b.a.mark(function n(e,t){var r;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r={},t&&(r.channel_url=t),n.abrupt("return",Object(I.c)(e,{endpoint:g.a.sendbirdServiceUrl+"/api/v1/opt_in",data:r,method:v.jb.POST,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 3:case"end":return n.stop()}},n,void 0)})),function(n,e){return c.apply(this,arguments)}),k=(s=p()(b.a.mark(function n(e,t,r,o){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{data:{users:r},endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/group_channels/"+o+"/invite",method:v.jb.POST,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e,t,r){return s.apply(this,arguments)}),x=(a=p()(b.a.mark(function n(e,t,r){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/group_channels/"+r+"/accept",method:v.jb.PUT,withCredentials:!0}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e,t){return a.apply(this,arguments)}),w=(d=p()(b.a.mark(function n(e,t){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(Object(C.a)(e,[y.a]),{endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/unread_message_count",method:v.jb.GET,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e){return d.apply(this,arguments)}),M=(l=p()(b.a.mark(function n(e,t){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{endpoint:g.a.sendbirdServiceUrl+"/api/v1/channels/recommended",method:v.jb.GET,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e){return l.apply(this,arguments)}),N=(f=p()(b.a.mark(function n(e,t,r,o){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(I.c)(e,{data:{channel_url:r,subreddit:o},endpoint:g.a.sendbirdServiceUrl+"/api/v1/sendbird/join",method:v.jb.POST,headers:{Accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},n,void 0)})),function(n,e,t,r){return f.apply(this,arguments)}),P=function(n,e,t){return Object(I.c)(n,{data:t,method:v.jb.POST,endpoint:g.a.sendbirdServiceUrl+"/api/v1/chat/ban",headers:{Accept:"application/json","Content-Type":"application/json"}})},U=function(n,e,t){return Object(I.c)(n,{data:{channel_url:Object(O.a)(e),modqueue_message_id:t},method:v.jb.PUT,endpoint:g.a.sendbirdServiceUrl+"/api/v1/chat/message/report",headers:{Accept:"application/json","Content-Type":"application/json"}})},A=function(n,e,t){return Object(I.c)(n,{data:{channel_url:Object(O.a)(e),modqueue_message_id:t},method:v.jb.DELETE,endpoint:g.a.sendbirdServiceUrl+"/api/v1/chat/message/report",headers:{Accept:"application/json","Content-Type":"application/json"}})}},"./src/chat/helpers/errors.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return a}),t.d(e,"b",function(){return d});var r=t("./node_modules/babel-runtime/helpers/classCallCheck.js"),o=t.n(r),i=t("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=t.n(i),c=t("./node_modules/babel-runtime/helpers/inherits.js"),s=t.n(c),a=function(n){function e(n,t){return o()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Invalid Value: '"+n+" is "+t+"'"))}return s()(e,n),e}(Error),d=function(n){0}},"./src/chat/helpers/unreadCount.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return i}),t.d(e,"a",function(){return u});var r=t("./src/chat/models/Promo/index.ts"),o={basicChannelCount:{count:0,unread:!1},subredditChannelCount:{count:0,unread:!1}},i=function(n){var e={};for(var t in n)e[t]={count:n[t],unread:!!n[t]};return Object.assign({},o,e)},u=function(n,e){var t=i(n),o=t.basicChannelCount,u=t.subredditChannelCount,c=Object(r.d)(e),s=Object(r.e)(c),a=o.count;return{count:a,unread:s||!!a||!!u.count}}},"./src/chat/helpers/urls/index.ts":function(n,e,t){"use strict";t.r(e),t.d(e,"minimizeUrl",function(){return u}),t.d(e,"rootUrl",function(){return c}),t.d(e,"basicChannelRootUrl",function(){return s}),t.d(e,"channelUrl",function(){return d}),t.d(e,"channelAction",function(){return l}),t.d(e,"channelUserIdUrl",function(){return f}),t.d(e,"getShortChannelUrl",function(){return m}),t.d(e,"messageActionUrl",function(){return b}),t.d(e,"userActionUrl",function(){return h}),t.d(e,"getSubredditFromUrl",function(){return p}),t.d(e,"viewProfileUrl",function(){return g}),t.d(e,"banUserUrl",function(){return v}),t.d(e,"getChannelUrl",function(){return I});var r=t("./src/config.ts"),o=t("./node_modules/query-string/index.js"),i=t("./src/chat/constants/channels.ts"),u="/chat/minimize/",c="/chat/",s="channel",a=function(n){return n?function(n){return"r/"+String(n).toLowerCase()+"/"+s}(n):s},d=function(n,e){return"/chat/"+a(e)+"/"+n},l=function(n,e,t){return"/chat/"+a(t)+"/"+n+"/"+e},f=function(n){return"/chat/user_id/"+n},m=function(n){return r.a.shortUrl+"/"+s+"/"+n},b=function(n,e,t,r){return{pathname:l(n,t,r)+"/message/"+e,state:{isOverlay:!0}}},h=function(n,e,t,r,i){return l(n,t,r)+"/user/"+e+(i?"?"+Object(o.stringify)(i):"")},p=function(n){return new RegExp("reddit.com").test(n)?n.replace(/^.+reddit.com(\/r\/.+?\/).*$/g,"$1"):""},g=function(n){return r.a.redditUrl+"/user/"+n},v=function(n){return r.a.redditUrl+"/r/"+n+"/about/banned"},I=function(n,e){var t=n.channelId,r=n.channelState,o=i.b.INVITED,u=i.b.PARTIAL,s=i.b.JOINED,a=i.a.VIEW_JOIN,f=i.a.VIEW_INVITE;switch(r){case o:return l(t,f,e);case u:return l(t,a,e);case s:return d(t,e);default:return c}}},"./src/chat/models/Channel/index.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return r}),t.d(e,"f",function(){return l}),t.d(e,"e",function(){return f}),t.d(e,"d",function(){return m}),t.d(e,"c",function(){return b}),t.d(e,"b",function(){return h});var r,o=t("./src/chat/constants/channels.ts"),i=t("./src/chat/models/Channel/subreddit.ts"),u=t("./src/chat/models/Channel/utils/index.ts"),c=t("./src/chat/models/Channel/utils/removeSendbirdPrefix.ts"),s=t("./src/chat/models/Message/index.ts"),a=t("./src/chat/models/User/inviter.ts"),d=t("./src/chat/models/User/member.ts");!function(n){n[n.Direct=0]="Direct",n[n.Group=1]="Group",n[n.Subreddit=2]="Subreddit"}(r||(r={}));o.b.UNSORTED,r.Direct;function l(n,e){var t=void 0,o=Object(u.d)(n);return o===r.Subreddit&&(t=Object(i.b)(n,e)),o!==r.Direct&&o!==r.Group&&t||(t=function(n,e){var t=n.coverUrl,o=n.createdAt,i=n.customType,l=n.data,f=n.memberCount,p=n.name,g=n.isDistinct,v=n.unreadMessageCount,I=n.unreadMentionCount,C=n.myCountPreference,y=n.inviter,O=n.lastMessage,j=n.members,S=n.url,_=n.myMemberState,T=n.isFrozen,E=n.myMutedState,k=n.myRole;return{channelId:Object(c.a)(S),channelSendbirdUrl:S,channelState:Object(u.b)(e,_),coverUrl:t,createdAt:Number(o),customType:i,data:l,maxLengthMessage:-1,memberCount:f,name:p,isFrozen:T,isModerator:b(k),isUserMuted:h(E),isMuted:m(C),inviter:Object(a.a)(y),type:g?r.Direct:r.Group,lastMessage:O?Object(s.b)(O):void 0,unreadMessageCount:v,unreadMentionCount:I,members:Object(d.a)(j),fetchingFirstMessage:!1,fetchingMessages:!1,fetchingMessagesError:!1,hasMoreMessages:!1,isMessageListLoaded:!1}}(n,e)),t}function f(n,e){for(var t={},r=0,o=n.length;r<o;r++){var i=l(n[r],e);if(!i||i.memberCount<2)break;t[i.channelId]=i}return t}var m=function(n){return n===o.c.Off},b=function(n){return"operator"===n},h=function(n){return"muted"===n}},"./src/chat/models/Channel/subreddit.ts":function(n,e,t){"use strict";t.d(e,"d",function(){return l}),t.d(e,"b",function(){return f}),t.d(e,"c",function(){return m}),t.d(e,"a",function(){return h});var r=t("./src/chat/constants/channels.ts"),o=t("./src/chat/models/Channel/index.ts"),i=t("./src/chat/models/Channel/utils/index.ts"),u=t("./src/chat/models/Channel/utils/removeSendbirdPrefix.ts"),c=t("./src/chat/models/Message/index.ts"),s=t("./src/chat/models/Subreddit/index.ts"),a=t("./src/chat/models/User/inviter.ts"),d=t("./src/chat/models/User/member.ts"),l=function(n){try{var e=JSON.parse(n),t=e.room_description,r=e.subreddit,o=e.subreddit,i=(o=void 0===o?{id:void 0}:o).id;if(i&&r)return{subredditId:i,subreddit:Object(s.b)(r),description:t||""}}catch(n){return void 0}};function f(n,e){var t=n.coverUrl,r=n.createdAt,s=n.customType,f=n.data,m=n.memberCount,b=n.name,h=n.unreadMessageCount,p=n.unreadMentionCount,g=n.inviter,v=n.isPublic,I=n.lastMessage,C=n.members,y=n.url,O=n.myMemberState,j=n.isFrozen,S=n.myCountPreference,_=n.myMutedState,T=n.myRole,E=l(f);if(E){var k=E.description,x=E.subreddit,w=E.subredditId;return{channelId:Object(u.a)(y),channelSendbirdUrl:y,channelState:Object(i.b)(e,O),coverUrl:t,createdAt:Number(r),customType:s,data:f,maxLengthMessage:-1,memberCount:m,name:b,isPublic:v,isFrozen:j,isModerator:Object(o.c)(T),isMuted:Object(o.d)(S),isUserMuted:Object(o.b)(_),inviter:Object(a.a)(g),type:o.a.Subreddit,lastMessage:I?Object(c.b)(I):void 0,unreadMessageCount:h,unreadMentionCount:p,members:Object(d.a)(C),fetchingFirstMessage:!1,fetchingMessages:!1,fetchingMessagesError:!1,hasMoreMessages:!1,isMessageListLoaded:!1,customData:{description:k.trim(),subreddit:x,subredditId:w}}}}function m(n,e){var t={};return n.forEach(function(n){var r=f(n,e);r&&(t[r.channelId]=r)}),{channels:t}}var b=function(n){if(n&&n.url&&n.name&&n.subreddit&&n.subreddit.id&&n.description&&n.member_count)return{channelId:Object(u.a)(n.url),channelSendbirdUrl:n.url,channelState:r.b.PARTIAL,fetchingMessages:!1,fetchingMessagesError:!1,hasMoreMessages:!1,isMessageListLoaded:!1,fetchingFirstMessage:!1,name:n.name,type:o.a.Subreddit,memberCount:n.member_count,customData:{subredditId:n.subreddit.id,description:n.description}}};function h(n){var e={};return n.forEach(function(n){if(n){var t=b(n);t&&(e[t.channelId]=t)}}),{channels:e}}},"./src/chat/models/Channel/utils/index.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return b}),t.d(e,"e",function(){return h}),t.d(e,"c",function(){return p}),t.d(e,"b",function(){return g}),t.d(e,"d",function(){return v});var r=t("./node_modules/lodash/keyBy.js"),o=t.n(r),i=t("./node_modules/lodash/pickBy.js"),u=t.n(i),c=t("./node_modules/lodash/sortBy.js"),s=t.n(c),a=t("./node_modules/lodash/toArray.js"),d=t.n(a),l=t("./src/chat/constants/channels.ts"),f=t("./src/chat/constants/sendbird.ts"),m=t("./src/chat/models/Channel/index.ts"),b=function(n){return f.a+n},h=function(n,e){return o()(s()(d()(n),e),"channelId")};function p(n,e){return u()(n,function(n){return e.includes(n.type)})}function g(n,e){return(n||e||l.b.UNSORTED).toUpperCase()}function v(n){var e=n.custom_type||n.customType;if("string"==typeof e){var t=e.split("_");switch(t.length&&t[0]){case"direct":return m.a.Direct;case"subreddit":return m.a.Subreddit;case"group":return m.a.Group}}return"boolean"==typeof n.is_super&&n.is_super||"boolean"==typeof n.isSuper&&n.isSuper?m.a.Subreddit:"boolean"==typeof n.is_distinct&&n.is_distinct||"boolean"==typeof n.isDistinct&&n.isDistinct?m.a.Direct:m.a.Group}},"./src/chat/models/Channel/utils/removeSendbirdPrefix.ts":function(n,e,t){"use strict";var r=t("./src/chat/constants/sendbird.ts");e.a=function(n){return n.replace(r.a,"")}},"./src/chat/models/Message/adapter.ts":function(n,e,t){"use strict";var r=t("./src/chat/constants/messages.ts"),o=t("./src/chat/models/Channel/utils/removeSendbirdPrefix.ts"),i=t("./src/chat/helpers/errors.ts");var u=t("./src/chat/helpers/urls/index.ts"),c={text:function(n){return{type:r.b.TEXT,value:n}},post:function(n){return{type:r.b.POST,value:n,subreddit:Object(u.getSubredditFromUrl)(n)}},embedCollection:function(n){var e=function(n,e){try{return JSON.parse(n)}catch(n){return Object(i.b)(n),e}}(n,{embed:void 0,url:void 0}),t=e.url,o=e.embed;if(t)return{type:r.b.EMBED,value:t,embed:o}},snoomoji:function(n){return{type:r.b.SNOOMOJI,value:n}}};t.d(e,"b",function(){return m}),t.d(e,"c",function(){return b}),t.d(e,"a",function(){return h});var s=r.b.TEXT,a=r.b.POST,d=r.b.EMBED,l=r.b.SNOOMOJI,f=function(n){try{return JSON.parse(n).v1}catch(n){return{}}},m=function(n){return f(n).clientMessageId||""},b=function(n,e){var t,r=f(e);return Object.assign({},function(n,e){if(e.snoomoji)return c[l](e.snoomoji);if(e.embed_data&&e.embed_data.url)return c[a](e.embed_data.url);if(e.embed_collection){var t=c[d](e.embed_collection);if(t)return t}return c[s](n)}(n,r),{clientMessageId:m(e),highlights:r.highlights||[]},r.report&&{report:(t=r.report,{channelIsPublic:t.channel_is_public,channelName:t.channel_name,channelId:t.channel_url&&Object(o.a)(t.channel_url),messageId:t.message_id,messageValue:t.message_value,messageCreatedAt:t.message_created_at,reason:t.reason,reportedUserId:t.reported_user_id,reportedUserName:t.reported_user_name,subredditId:t.subreddit_id,subredditName:t.subreddit_name,actions:Object.assign({},t.actions&&t.actions.deleted&&{deleted:{status:t.actions.deleted.status,userId:t.actions.deleted.user_id,userName:t.actions.deleted.user_name,updatedTs:t.actions.deleted.updated_ts}},t.actions&&t.actions.ignored&&{ignored:{status:t.actions.ignored.status,userId:t.actions.ignored.user_id,userName:t.actions.ignored.user_name,updatedTs:t.actions.ignored.updated_ts}})})})},h=function(n,e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{v1:Object.assign({clientMessageId:t,highlights:r},e===l?{snoomoji:n}:{},e===a?{embed_data:{url:n}}:{},e===d?{embed_collection:n}:{})}}},"./src/chat/models/Message/index.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return d}),t.d(e,"a",function(){return l});var r=t("./node_modules/uuid/v4.js"),o=t.n(r),i=t("./src/chat/constants/messages.ts"),u=t("./src/chat/models/Channel/utils/removeSendbirdPrefix.ts"),c=t("./src/chat/models/Message/adapter.ts"),s=t("./src/chat/selectors/messages.ts"),a=t("./src/chat/selectors/user.ts");function d(n){if(n&&n.messageType===i.c.USER){var e=n.channelUrl,t=n.messageType,r=n.messageId,o=n.createdAt,s=n.updatedAt,a=n.channelType,d=n.message,l=n.data,f=n.customType;return{channelId:Object(u.a)(e),channelSendbirdUrl:e,messageType:i.c[t],messageId:r,createdAt:o,updatedAt:s,channelType:a,data:l,messageData:Object(c.c)(d,l),sender:function(n){if(n&&n.messageType===i.c.USER)return n.sender}(n),customType:f}}}function l(n,e,t,r){var u=o()(),d=Object(s.c)(n,t),l=JSON.stringify(Object(c.a)(t,r,u,d));return{channelId:e,clientMessageId:u,createdAt:(new Date).getTime(),data:l,messageData:Object(c.c)(t,l),messageType:i.c.PENDING,error:!1,sender:{nickname:Object(a.b)(n),userId:Object(a.a)(n)}}}},"./src/chat/models/Promo/index.ts":function(n,e,t){"use strict";var r,o,i;t.d(e,"a",function(){return r}),t.d(e,"b",function(){return o}),t.d(e,"c",function(){return i}),t.d(e,"d",function(){return u}),t.d(e,"e",function(){return c}),function(n){n.SubredditChatFtux="displaySubredditChatFtux"}(r||(r={})),function(n){n.NSFWWarning="displayNSFWWarning"}(o||(o={})),function(n){n.LegacyNSFWWarning="nsfwWarning",n.LegacySubredditChatFtux="firstTimeUserExp"}(i||(i={}));var u=function(n){var e={};for(var t in n)switch(t){case r.SubredditChatFtux:e[t]=n[t]}return e},c=function(n){for(var e in n)if(!0===n[e])return!0;return!1}},"./src/chat/models/Subreddit/index.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return o}),t.d(e,"a",function(){return i}),t.d(e,"c",function(){return u});var r=t("./src/chat/models/Channel/subreddit.ts");function o(n){return{id:n.id,name:n.name,description:n.description,iconImg:n.icon_img,keyColor:n.key_color,nsfw:n.nsfw}}function i(n){var e={};return n.forEach(function(n){if(n&&n.subreddit){var t=o(n.subreddit);e[t.id]=t}}),e}function u(n){var e={};return n.forEach(function(n){var t=Object(r.d)(n.data);if(t){var o=t.subreddit;o&&(e[o.id]=o)}}),e}},"./src/chat/models/User/inviter.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return i}),t.d(e,"a",function(){return u});var r="t2_1qwk",o="reddit";function i(n){if(n)return{id:n.user_id,name:n.nickname}}function u(n){return{id:n?n.userId:r,name:n?n.nickname:o}}},"./src/chat/models/User/member.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return r});var r=function(n){return n.length&&n.map(function(n){return{id:n.user_id||n.userId,isOnline:n.is_online||n.isOnline,lastSeenAt:n.last_seen_at||n.lastSeenAt,name:n.nickname,profileUrl:n.profile_url||n.profileUrl,state:n.state,isBlockedByMe:n.isBlockedByMe}}).filter(function(n){return n})||[]}},"./src/chat/selectors/channels.ts":function(n,e,t){"use strict";var r,o=t("./node_modules/babel-runtime/helpers/toConsumableArray.js"),i=t.n(o),u=t("./node_modules/lodash/flatten.js"),c=t.n(u),s=t("./node_modules/lodash/sortBy.js"),a=t.n(s),d=t("./node_modules/lodash/toArray.js"),l=t.n(d),f=t("./node_modules/lodash/uniqBy.js"),m=t.n(f),b=t("./node_modules/lodash/values.js"),h=t.n(b);!function(n){n.DEFAULT="default",n.BANNED="banned",n.KICKED="kicked"}(r||(r={}));var p=t("./src/chat/constants/channels.ts");t("./src/chat/models/Channel/index.ts");t.d(e,"n",function(){return g}),t.d(e,"r",function(){return v}),t.d(e,"s",function(){return I}),t.d(e,"t",function(){return C}),t.d(e,"p",function(){return j}),t.d(e,"h",function(){return S}),t.d(e,"k",function(){return _}),t.d(e,"l",function(){return T}),t.d(e,"w",function(){return E}),t.d(e,"x",function(){return k}),t.d(e,"m",function(){return x}),t.d(e,"j",function(){return w}),t.d(e,"u",function(){return M}),t.d(e,"b",function(){return N}),t.d(e,"O",function(){return P}),t.d(e,"g",function(){return U}),t.d(e,"f",function(){return A}),t.d(e,"y",function(){return D}),t.d(e,"z",function(){return B}),t.d(e,"A",function(){return R}),t.d(e,"E",function(){return L}),t.d(e,"e",function(){return F}),t.d(e,"P",function(){return V}),t.d(e,"F",function(){return W}),t.d(e,"C",function(){return J}),t.d(e,"c",function(){return H}),t.d(e,"G",function(){return G}),t.d(e,"H",function(){return K}),t.d(e,"J",function(){return z}),t.d(e,"I",function(){return q}),t.d(e,"i",function(){return X}),t.d(e,"v",function(){return Y}),t.d(e,"o",function(){return Z}),t.d(e,"K",function(){return $}),t.d(e,"a",function(){return Q}),t.d(e,"L",function(){return nn}),t.d(e,"D",function(){return en}),t.d(e,"d",function(){return tn}),t.d(e,"q",function(){return rn}),t.d(e,"M",function(){return on}),t.d(e,"N",function(){return un}),t.d(e,"B",function(){return cn});var g=function(n){return n.channels.invited.sortedKeys.length},v=function(n){return n.channels.joined.sortedKeys.length},I=function(n){return c()(l()(n.channels.subreddit.joined.sortedKeys)).length},C=function(n,e,t){var r=e&&h()(e.channels)||t||[],o=function(n){var e=n.channels,t=e.models,r=e.subreddit.joined;return c()(h()(r.sortedKeys)).map(function(n){return t[n]})}(n),u=m()([].concat(i()(o),i()(r)),function(n){return n.channelId}),s=y(n,u);return O(n,s)},y=function(n,e){var t=n.subreddits.models;return a()(e,[function(n){return t[n.customData.subredditId].name.toLowerCase()}],function(n){return n.name.toLowerCase()})},O=function(n,e){var t=n.subreddits.models;return e.reduce(function(n,e){var r=e.channelId,o=e.customData.subredditId,i=t[o].name.toLowerCase();return n[i]=n[i]||[],n[i].push(r),n},{})},j=function(n){return n.channels.subreddit.invited.sortedKeys.length},S=function(n,e){return e?n.channels.models[e]:void 0},_=function(n){var e=n.platform.currentPage,t=e&&e.urlParams.channelId;if(t)return S(n,t)},T=function(n){var e=_(n);if(e&&e.channelState===p.b.JOINED)return e},E=function(n){var e=n.channels.selected.channelId;if(e)return S(n,e)},k=function(n){return n.channels.selected&&n.channels.selected.channelId},x=function(n){return _(n)||E(n)},w=function(n,e){var t=e||x(n);return t&&t.members&&t.members.map(function(n){return n.id})},M=function(n){var e=n.user,t=x(n);if(t&&t.members)return t.members.filter(function(n){return n.id!==e.account.id})},N=function(n,e){var t=M(n);return!(!t||!t.find(function(n){return!!e[n.id].isNSFW}))},P=function(n){return!!T(n)},U=function(n){var e=M(n);return e&&e.filter(function(n){return n.isBlockedByMe})},A=function(n){var e=[],t=n.user.account.id;return h()(n.channels.models).forEach(function(n){if(n&&n.members){var r=n.members.filter(function(n){return n.id!==t}).map(function(n){return n.id});r.length&&e.push(r)}}),e.length&&e},D=function(n){return h()(n.messages.models).filter(function(e){return e.channelId===n.channels.selected.channelId})},B=function(n){return h()(n.messages.pending).filter(function(e){return e.channelId===n.channels.selected.channelId})},R=function(n,e){var t=E(n);return t&&t[e]},L=function(n){return n.channels.joined.hasMoreChannels},F=function(n){return n.channels.joined.fetchingChannels},V=function(n){return n.channels.joined.sortedKeys.map(function(e){return n.channels.models[e]})},W=function(n){return n.channels.inviteListExpanded},J=function(n){return n.channels.invited.hasMoreChannels},H=function(n){return n.channels.invited.fetchingChannels},G=function(n){return n.channels.invited.sortedKeys.map(function(e){return n.channels.models[e]})},K=function(n){var e=E(n);return e&&e.inviter&&e.inviter.name},z=function(n){var e=_(n);return!(!e||!e.isMessageListLoaded)},q=function(n){return n.channels.isCreatingChannel},X=function(n){var e=E(n);return e&&e.channelState},Y=function(n){var e=n.channels.subreddit.recommended.sortedKeys.map(function(e){return n.channels.models[e]}),t=[];return e&&e.length&&(t=e.filter(function(n){return!(!n||n.channelState===p.b.JOINED)})),t},Z=function(n){var e=n.channels.subreddit.invited.sortedKeys;return e&&e.map(function(e){return n.channels.models[e]})},$=function(n,e){return!(!e||!n.channels.subreddit.recommended.sortedKeys.includes(e))},Q=function(n){var e=_(n);return!(!e||!e.isModerator)},nn=function(n,e){var t=S(n,e);return!(!t||!$(n,e)||t.channelState===p.b.JOINED)},en=function(n){return n.channels.subreddit.invited.hasMoreChannels},tn=function(n){return n.channels.subreddit.invited.fetchingChannels},rn=function(n,e){if(e)return n.channels.subreddit.kicked.sortedKeys.includes(e)?r.KICKED:n.channels.subreddit.banned.sortedKeys.includes(e)?r.BANNED:r.DEFAULT},on=function(n){var e=x(n);return!(!e||!e.isFrozen)},un=function(n){var e=x(n);return!(!e||!e.isMuted)},cn=function(n){var e=x(n);return e&&e.customData&&e.customData.subreddit&&e.customData.subreddit.id}},"./src/chat/selectors/messages.ts":function(n,e,t){"use strict";t.d(e,"j",function(){return c}),t.d(e,"i",function(){return s}),t.d(e,"d",function(){return a}),t.d(e,"e",function(){return d}),t.d(e,"f",function(){return l}),t.d(e,"g",function(){return f}),t.d(e,"h",function(){return m}),t.d(e,"b",function(){return b}),t.d(e,"c",function(){return h}),t.d(e,"a",function(){return p}),t.d(e,"k",function(){return g});var r=t("./src/lib/linkMatchers/customLinks.ts"),o=t("./src/chat/helpers/unreadCount.ts"),i=t("./src/chat/selectors/channels.ts"),u=t("./src/chat/selectors/promos.ts"),c=function(n){var e=Object(i.n)(n);return n.messages.unread.basicChannelCount-e||0},s=function(n){return n.messages.unread},a=function(n,e){if(e)return n.messages.models[e]},d=function(n,e){var t=a(n,e);return t&&t.sender},l=function(n,e){var t=d(n,e);return t&&t.userId},f=function(n,e){var t=a(n,e);return t&&t.messageData.type},m=function(n,e){return n.messages.pending[e]},b=function(n){var e=Object(i.k)(n);if(e&&e.firstMessageId)return n.messages.models[e.firstMessageId]},h=function(n,e){var t=Object(i.a)(n);return Object.keys(r.b).map(function(n){return t&&e.includes("@"+r.b[n])&&r.b[n]}).filter(function(n){return n})},p=function(n){var e=s(n),t=Object(u.b)(n);return Object(o.a)(e,t)},g=function(n){var e=s(n);return Object(o.b)(e)}},"./src/chat/selectors/promos.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return r}),t.d(e,"c",function(){return o}),t.d(e,"a",function(){return i});var r=function(n){return n.promos},o=function(n){return n.promos.displaySubredditChatFtux},i=function(n){return n.promos.displayNSFWWarning}},"./src/chat/selectors/user.ts":function(n,e,t){"use strict";t.d(e,"a",function(){return r}),t.d(e,"b",function(){return o}),t.d(e,"f",function(){return i}),t.d(e,"c",function(){return u}),t.d(e,"e",function(){return c}),t.d(e,"d",function(){return s});var r=function(n){return n.user.account.id},o=function(n){return n.user.account.name},i=function(n){return!!n.user.account},u=function(n){return n.user.session},c=function(n){return!!n.user.account&&n.user.account.seenSubredditChatFtux},s=function(n){return n.user.account}},"./src/lib/cache/index.ts":function(n,e,t){"use strict";var r=t("./src/lib/constants/index.ts"),o=t("./src/lib/redditId/index.ts"),i=t("./src/lib/logs/console.ts"),u=t("./src/lib/safeJSONParse/index.ts"),c=function(n){var e=void 0;try{if(!(e=localStorage.getItem(n)))return}catch(e){return void Object(i.a)(e,'localStorage cache get("'+n+'") error')}var t=Object(u.a)(e);if(t){if(!(t.expires<Date.now()))return t.value}else Object(i.a)(void 0,'localStorage cache get("'+n+'") error parsing: '+t)},s=function(n,e,t){var r={expires:"number"==typeof t?Date.now()+1e3*t:t.getTime(),value:e};try{return localStorage.setItem(n,JSON.stringify(r)),!0}catch(e){Object(i.a)(e,'localStorage cache set("'+n+'") error')}return!1};t.d(e,"a",function(){return a}),t.d(e,"c",function(){return d}),t.d(e,"b",function(){return l}),t.d(e,"d",function(){return f});r.N;var a=r.Ec,d=function(n,e,t){return n+"."+e+(t?"{"+Object(o.b)(t,r.wb.ACCOUNT)+"}":"")},l=c,f=s},"./src/lib/linkMatchers/customLinks.ts":function(n,e,t){"use strict";var r,o,i=function(n,e){return function(t,r,o){if(r>n.length){var i=/\s/,u=t[r-n.length-1];if(!u.match(i)){if("/"!==u)return 0;var c=r-n.length-2;if(c>=0&&!t[c].match(i))return 0}}var s=t.slice(r);return e.test(s)?s.match(e)[0].length:0}};t.d(e,"b",function(){return r}),t.d(e,"c",function(){return o}),t.d(e,"d",function(){return a}),t.d(e,"a",function(){return d}),t.d(e,"e",function(){return l}),function(n){n.All="all",n.Here="here"}(r||(r={})),function(n){n.subreddit="r/",n.subredditFull="/r/",n.profile="u/",n.profileFull="/u/",n.mention="@"}(o||(o={}));var u=new RegExp("^[A-Za-z0-9_-]{0,20}\\b"),c=new RegExp("^[A-Za-z0-9][A-Za-z0-9_]{0,20}\\b"),s=new RegExp("^@"+r.All,"i"),a=new RegExp("^/?(u|r)/","i"),d=new RegExp("^/?(u/|@)","i"),l=o.subreddit,f={subreddit:{prefix:o.subreddit,config:{validate:i(o.subreddit,c),normalize:function(n){n.url="/r/"+n.url.replace(a,"")}}},profile:{prefix:o.profile,config:{validate:i(o.profile,u),normalize:function(n){n.url="/user/"+n.url.replace(a,"")}}},mention:{prefix:o.mention,config:{validate:i(o.mention,u),normalize:function(n){s.test(n.text)?n.url="":n.url="/user/"+n.url.replace(d,"")}}}},m={subredditFull:{prefix:o.subredditFull,config:f.subreddit.config},profileFull:{prefix:o.profileFull,config:f.profile.config}},b=Object.assign({},f,m);e.f=b},"./src/lib/messageIframeParent/index.ts":function(n,e,t){"use strict";e.a=function(n,e){var t=n.type,r=n.data,o=void 0===r?{}:r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";if(window.parent!==window){var u={type:e?t+"."+e:t,data:o};window.parent.postMessage(JSON.stringify(u),i)}}},"./src/lib/safeJSONParse/index.ts":function(n,e,t){"use strict";function r(n){try{return JSON.parse(n)}catch(n){}}t.d(e,"a",function(){return r})},"./src/reddit/constants/theme.ts":function(n,e,t){"use strict";t.d(e,"b",function(){return r}),t.d(e,"a",function(){return o});var r={REDDIT:"REDDIT",NIGHT:"NIGHT"},o=r.REDDIT},"./src/reddit/models/Theme/index.ts":function(n,e,t){"use strict";var r=t("./node_modules/babel-runtime/helpers/defineProperty.js"),o=t.n(r),i=t("./node_modules/polished/dist/polished.es.js"),u=t("./src/reddit/constants/theme.ts"),c=t("./src/reddit/models/NewStructuredStyles/index.ts"),s=t("./src/reddit/models/StructuredStyles/index.ts");var a,d=t("./src/reddit/models/Theme/NewColorSystem/index.ts");t.d(e,"a",function(){return l}),t.d(e,"e",function(){return m}),t.d(e,"g",function(){return p}),t.d(e,"f",function(){return S}),t.d(e,"c",function(){return T}),t.d(e,"h",function(){return E}),t.d(e,"j",function(){return k}),t.d(e,"i",function(){return x}),t.d(e,"b",function(){return w}),t.d(e,"d",function(){return M});var l={small:64,medium:128,large:192},f={show:!0,hide:!1};function m(n,e,t){if("pretty"===t)return[n];if("slashtag"===t){if(e){var r=e.indexOf("/");return[e.slice(0,r+1),e.slice(r+1)]}return["r/",n]}return null}var b=function(n,e){var t=e/100,r=Object(i.d)(n);return r.alpha=t,Object(i.j)(r)},h=function(n,e){return Object(i.g)(n,e)},p=function(n,e,t){return e?[n,"url("+e+")",function(n){switch(n){case"cover":return"no-repeat center / cover";case"tiled":return"repeat center top";case"centered":return"no-repeat center top";default:return""}}(t)].filter(Boolean).join(" "):n},g=(s.c,{}),v={borderRadius:"24",customSize:"32",padding:"6",size:"24"},I=function(n){return"overlay"===n.menuPosition?n.bannerOverlayColor?b(n.bannerOverlayColor,n.menuBackgroundOpacity):b(n.primaryColor,n.menuBackgroundOpacity):"default"===n.menuPosition?n.menuBackgroundColor||h(.93,n.primaryColor):void 0},C=function(n){return"custom"===n.submenuBackgroundStyle?n.submenuBackgroundColor||h(.93,n.primaryColor):n.menuBackgroundColor||h(.93,n.primaryColor)},y=function(n){var e=l[n.bannerHeight];return"overlay"===n.menuPosition&&(e+=36),e},O=function(n){return parseInt(l[n])-16},j={shouldShowNSFWContent:!1},S=function(n){return n&&Object(i.b)(n)<.5?c.a.body:c.a.bodyText},_=function(n){return Object(i.b)(n)>.9?Object(i.a)(.1,n):n},T=k(s.c,j);function E(n,e,t){return n||e&&h(.6,e)||t&&h(.6,t)||c.a.banner.backgroundColor}function k(n,e){return{subredditContext:e,communityTheme:{},newCommunityTheme:Object(d.e)({active:n.primaryColor,banner:{backgroundColor:function(n){return n.bannerBackgroundColor||h(.6,n.primaryColor)||c.a.banner.backgroundColor}(n),backgroundImage:n.bannerBackgroundImage,backgroundImagePosition:n.bannerBackgroundImagePosition,communityNameFormat:n.bannerCommunityNameFormat,iconColor:n.primaryColor,iconImage:n.communityIcon,iconDimensions:"small"===n.bannerHeight?v:d.f,lineHeight:"small"===n.bannerHeight?"38":"60",height:y(n),positionedImage:n.bannerPositionedImage,positionedImageHeight:O(n.bannerHeight),positionedImageAlignment:n.bannerPositionedImagePosition,secondaryBannerPositionedImage:n.secondaryBannerPositionedImage,showCommunityIcon:f[n.bannerShowCommunityIcon]},button:n.highlightColor?_(n.highlightColor):c.a.button,canvas:n.backgroundColor||c.a.canvas,canvasImgUrl:n.backgroundImage,canvasImgPosition:n.backgroundImagePosition,linkText:n.highlightColor?_(n.highlightColor):c.a.linkText,menu:n.menuBackgroundColor||c.a.menu,menuActiveText:n.menuLinkColorActive||c.a.menuActiveText,menuInactiveText:n.menuLinkColorInactive||c.a.menuInactiveText,navBar:{activeLink:n.menuLinkColorActive||n.highlightColor,activeSubmenuCaret:n.primaryColor,activeSubmenuLink:n.primaryColor,backgroundColor:I(n)||"",backgroundImage:"overlay"!==n.menuPosition?n.menuBackgroundImage:void 0,hoverLink:n.menuLinkColorHover||n.highlightColor,inactiveLink:n.menuLinkColorInactive||n.primaryColor,inactiveSubmenuCaret:h(.6,n.primaryColor),inactiveSubmenuLink:h(.6,n.primaryColor),submenuBackgroundColor:C(n),useOverlay:"overlay"===n.menuPosition},post:!n.postBackgroundColor||e.isOverlay||e.isCommentsPage?c.a.post:n.postBackgroundColor,titleText:n.postTitleColor&&!e.isOverlay?n.postTitleColor:c.a.titleText,voteText:{base:c.a.voteText.base,upvote:n.postUpvoteCountColor||c.a.voteText.upvote,downvote:n.postDownvoteCountColor||c.a.voteText.downvote},voteIcons:{upvoteActive:"custom"===n.postVoteIcons?n.postUpvoteIconActive:void 0,upvoteInactive:"custom"===n.postVoteIcons?n.postUpvoteIconInactive:void 0,downvoteActive:"custom"===n.postVoteIcons?n.postDownvoteIconActive:void 0,downvoteInactive:"custom"===n.postVoteIcons?n.postDownvoteIconInactive:void 0},widgetColors:{sidebarWidgetBackgroundColor:n.sidebarWidgetBackgroundColor||c.a.widgetColors.sidebarWidgetBackgroundColor,sidebarWidgetHeaderColor:n.sidebarWidgetHeaderColor||c.a.widgetColors.sidebarWidgetHeaderColor,lineColor:Object(d.d)(S(n.sidebarWidgetBackgroundColor))}},{backgroundImage:e.isOverlay?void 0:n.postBackgroundImage,backgroundImagePosition:n.postBackgroundImagePosition,placeholderImage:n.postPlaceholderImage,placeholderImagePosition:n.postPlaceholderImagePosition},!1),redditTheme:g,newRedditTheme:Object(d.e)(c.a,{},!1)}}function x(n,e){return{subredditContext:e,communityTheme:{},newCommunityTheme:Object(d.e)({banner:{backgroundColor:Object(i.h)(.9,n.bannerBackgroundColor||h(.6,n.primaryColor)||c.b.banner.backgroundColor),backgroundImage:n.bannerBackgroundImage,backgroundImagePosition:n.bannerBackgroundImagePosition,communityNameFormat:n.bannerCommunityNameFormat,iconColor:n.primaryColor,iconImage:n.communityIcon,iconDimensions:"small"===n.bannerHeight?v:d.f,lineHeight:"small"===n.bannerHeight?"38":"60",height:y(n),positionedImage:n.bannerPositionedImage,positionedImageHeight:O(n.bannerHeight),positionedImageAlignment:n.bannerPositionedImagePosition,secondaryBannerPositionedImage:n.secondaryBannerPositionedImage,showCommunityIcon:f[n.bannerShowCommunityIcon]},voteIcons:{upvoteActive:"custom"===n.postVoteIcons?n.postUpvoteIconActive:void 0,upvoteInactive:"custom"===n.postVoteIcons?n.postUpvoteIconInactive:void 0,downvoteActive:"custom"===n.postVoteIcons?n.postDownvoteIconActive:void 0,downvoteInactive:"custom"===n.postVoteIcons?n.postDownvoteIconInactive:void 0},widgetColors:c.b.widgetColors},{backgroundImage:void 0,backgroundImagePosition:void 0,placeholderImage:n.postPlaceholderImage,placeholderImagePosition:n.postPlaceholderImagePosition},!0),redditTheme:g,newRedditTheme:Object(d.e)(c.b,{},!0)}}var w=x(s.c,j),M=(a={},o()(a,u.b.REDDIT,T),o()(a,u.b.NIGHT,w),a)}}]);
//# sourceMappingURL=Legacy~Chat~Governance~Reddit~RedesignChat.429b16919b02a078b7cd.js.map